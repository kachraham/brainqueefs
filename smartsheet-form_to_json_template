import time
import datetime
from datetime import date
import json

import smartsheet
ss = smartsheet.Smartsheet(***YOUR SMARTSHEET KEY***)
ss.errors_as_exceptions(True)

from jira import JIRA
options = {'server': ***YOUR JIRA ENVIRONMENT***}
username = ***YOUR JIRA USERNAME***
api_key = ***YOUR JIRA API KEY***
jira = JIRA(options, basic_auth=(username,api_key))

print('What is the name of the client?')
client_name = input('> ')

#EMAIL DEFAULTS DICTIONARY
email_vars = {
'APP_REGISTRATION_SUBJECT' : client_name + "DEFAULT LANGUAGE",
'APP_REGISTRATION_H1' : client_name + " - Activate Your Borrower Wallet Account",
'APP_REGISTRATION_BODY' : '''DEFAULT LANGUAGE''',

'APP_INVITENEW_SUBJECT' : client_name + "DEFAULT LANGUAGE",
'APP_INVITENEW_H1' : client_name + "DEFAULT LANGUAGE",
'APP_INVITENEW_BODY' : '''DEFAULT LANGUAGE''',

'APP_MFA_SUBJECT' : "DEFAULT LANGUAGE",
'APP_MFA_H1' : "DEFAULT LANGUAGE",
'APP_MFA_BODY' : '''DEFAULT LANGUAGE''',

'APP_INVITEEXISTING_SUBJECT' : client_name + "DEFAULT LANGUAGE",
'APP_INVITEEXISTING_H1' : client_name + "DEFAULT LANGUAGE",
'APP_INVITEEXISTING_BODY' : '''DEFAULT LANGUAGE''',

'APP_FELLOWNEW_SUBJECT' : client_name + "DEFAULT LANGUAGE",
'APP_FELLOWNEW_H1' : client_name + "DEFAULT LANGUAGE", 
'APP_FELLOWNEW_BODY' : '''DEFAULT LANGUAGE''',

'APP_FELLOWEXISTING_SUBJECT' : client_name + "DEFAULT LANGUAGE", 
'APP_FELLOWEXISTING_H1' : client_name + "DEFAULT LANGUAGE",
'APP_FELLOWEXISTING_BODY' : ''DEFAULT LANGUAGE''',

'APP_RESETPASSWORD_SUBJECT' : client_name + "DEFAULT LANGUAGE", 
'APP_RESETPASSWORD_H1' : client_name + "DEFAULT LANGUAGE",  
'APP_RESETPASSWORD_BODY' : '''DEFAULT LANGUAGE''',

'APP_TEAMMEMBER_SUBJECT' : client_name + "DEFAULT LANGUAGE", 
'APP_TEAMMEMBER_H1' : client_name + "DEFAULT LANGUAGE", 
'APP_TEAMMEMBER_BODY' : '''DEFAULT LANGUAGE''',

'APP_PREQUAL_SUBJECT' : client_name + "DEFAULT LANGUAGE",
'APP_PREQUAL_H1' :  client_name + "DEFAULT LANGUAGE", 
'APP_PREQUAL_BODY' : '''DEFAULT LANGUAGE''', 

'APP_DISCLOSURES_SUBJECT' : client_name + "DEFAULT LANGUAGE", 
'APP_DISCLOSURES_H1' : client_name + "DEFAULT LANGUAGE", 
'APP_DISCLOSURES_BODY' : '''DEFAULT LANGUAGE.''',

'APP_RATELOCK_SUBJECT' : client_name + "DEFAULT LANGUAGE",
'APP_RATELOCK_H1' : client_name + "DEFAULT LANGUAGE", 
'APP_RATELOCK_BODY' : "DEFAULT LANGUAGE",

'APP_LOSUBMIT_SUBJECT' : client_name + "DEFAULT LANGUAGE", 
'APP_LOSUBMIT_H1' : client_name + "DEFAULT LANGUAGE", 
'APP_LOSUBMIT_BODY' : '''DEFAULT LANGUAGE''',

'APP_DOCUMENT_SUBJECT' : client_name + "DEFAULT LANGUAGE",  
'APP_DOCUMENT_H1' : client_name + "DEFAULT LANGUAGE", 
'APP_DOCUMENT_BODY' : '''DEFAULT LANGUAGE''',

'PROC_ASSIGN_SUBJECT' : client_name + "DEFAULT LANGUAGE", 
'PROC_ASSIGN_H1' : client_name + "DEFAULT LANGUAGE", 
'PROC_ASSIGN_BODY' : '''DEFAULT LANGUAGE''',

'LO_ASSIGN_SUBJECT' : "DEFAULT LANGUAGE", 
'LO_ASSIGN_H1' : "DEFAULT LANGUAGE", 
'LO_ASSIGN_BODY' : '''DEFAULT LANGUAGE''', 

'LO_PREQUAL_SUBJECT' : "DEFAULT LANGUAGE", 
'LO_PREQUAL_H1' : "DEFAULT LANGUAGE", 
'LO_PREQUAL_BODY' : "DEFAULT LANGUAGE", 

'LO_CREDITREPORT_SUBJECT' : "DEFAULT LANGUAGE",
'LO_CREDITREPORT_H1' : "DEFAULT LANGUAGE", 
'LO_CREDITREPORT_BODY' : "DEFAULT LANGUAGE", 

'LO_APPSUBMIT_SUBJECT' : "DEFAULT LANGUAGE", 
'LO_APPSUBMIT_H1' : "DEFAULT LANGUAGE", 
'LO_APPSUBMIT_BODY' : "DEFAULT LANGUAGE", 

'LO_DISCLOSURES_SUBJECT' : "DEFAULT LANGUAGE", 
'LO_DISCLOSURES_H1' : "DEFAULT LANGUAGE", 
'LO_DISCLOSURES_BODY' : '''DEFAULT LANGUAGE'''
}

#SMARTSHEET
onboarding = '5819002468493188' #Implementation Kickoff
sheet = ss.Sheets.get_sheet(onboarding) #sheet = Implementation Kickoff
for row in sheet.rows:
	if row.cells[0].value == client_name:
		global CLIENT_LEGAL_NAME, NMLS
		CLIENT_LEGAL_NAME = str(row.cells[0].value)
		NMLS = str(row.cells[6].value)[:-2] #NMLS number

email_configurations = '2196800594569092' #(Form) Email Configurations
sheet = ss.Sheets.get_sheet(email_configurations) #sheet = Integration - The Work Number - Client Info
for row in sheet.rows:
	if row.cells[0].value == client_name:
		global SENDER_EMAIL_ADDRESS, GREETING, SIGNOFF, TEAM_NAME, FOOTER, PHONE_NUMBER, CLIENT_SS_ROW
		CLIENT_SS_ROW = row.id
		SENDER_EMAIL_ADDRESS = str(row.cells[3].value)
		GREETING = str(row.cells[4].value) #GREETING ESTABLISHED MULTIPLE TIMES ACROSS JSON FORMAT; NEED TO IDENTIFY EACH AND SUPPLANT VARIABLE
		SIGNOFF = str(row.cells[5].value)
		TEAM_NAME = str(row.cells[6].value)
		FOOTER = str(row.cells[7].value)
		PHONE_NUMBER = str(row.cells[80].value)
		
		if str(row.cells[8].value) != '':
			email_vars['APP_REGISTRATION_SUBJECT'] = str(row.cells[8].value)
		if str(row.cells[9].value) != '':
			email_vars['APP_REGISTRATION_H1'] = str(row.cells[9].value)		
		if str(row.cells[10].value) != '':
			email_vars['APP_REGISTRATION_BODY'] = str(row.cells[10].value)
		
		if str(row.cells[11].value) != '':
			email_vars['APP_INVITENEW_SUBJECT'] = str(row.cells[11].value)
		if str(row.cells[12].value) != '':
			email_vars['APP_INVITENEW_H1'] = str(row.cells[12].value)
		if str(row.cells[13].value) != '':
			email_vars['APP_INVITENEW_BODY'] = str(row.cells[13].value)	

		if str(row.cells[14].value) != '':
			email_vars['APP_MFA_SUBJECT'] = str(row.cells[14].value)
		if str(row.cells[15].value) != '':
			email_vars['APP_MFA_H1'] = str(row.cells[15].value)
		if str(row.cells[16].value) != '':
			email_vars['APP_MFA_BODY'] = str(row.cells[16].value)

		if str(row.cells[17].value) != '':
			email_vars['APP_INVITEEXISTING_SUBJECT'] = str(row.cells[17].value)
		if str(row.cells[18].value) != '':
			email_vars['APP_INVITEEXISTING_H1'] = str(row.cells[18].value)
		if str(row.cells[19].value) != '':
			email_vars['APP_INVITEEXISTING_BODY'] = str(row.cells[19].value)	

		if str(row.cells[20].value) != '':
			email_vars['APP_FELLOWNEW_SUBJECT'] = str(row.cells[20].value)
		if str(row.cells[21].value) != '':
			email_vars['APP_FELLOWNEW_H1'] = str(row.cells[21].value)
		if str(row.cells[22].value) != '':
			email_vars['APP_FELLOWNEW_BODY'] = str(row.cells[22].value)	

		if str(row.cells[23].value) != '':
			email_vars['APP_FELLOWEXISTING_SUBJECT'] = str(row.cells[23].value)
		if str(row.cells[24].value) != '':
			email_vars['APP_FELLOWEXISTING_H1'] = str(row.cells[24].value)
		if str(row.cells[25].value) != '':
			email_vars['APP_FELLOWEXISTING_BODY'] = str(row.cells[25].value)	

		if str(row.cells[26].value) != '':
			email_vars['APP_RESETPASSWORD_SUBJECT'] = str(row.cells[26].value)
		if str(row.cells[27].value) != '':
			email_vars['APP_RESETPASSWORD_H1'] = str(row.cells[27].value)
		if str(row.cells[28].value) != '':
			email_vars['APP_RESETPASSWORD_BODY'] = str(row.cells[28].value)

		if str(row.cells[29].value) != '':
			email_vars['APP_TEAMMEMBER_SUBJECT'] = str(row.cells[29].value)
		if str(row.cells[30].value) != '':
			email_vars['APP_TEAMMEMBER_H1'] = str(row.cells[30].value)
		if str(row.cells[31].value) != '':
			email_vars['APP_TEAMMEMBER_BODY'] = str(row.cells[31].value)

		if str(row.cells[32].value) != '':
			email_vars['APP_DISCLOSURES_SUBJECT'] = str(row.cells[32].value)
		if str(row.cells[33].value) != '':
			email_vars['APP_DISCLOSURES_H1'] = str(row.cells[33].value)
		if str(row.cells[34].value) != '':
			email_vars['APP_DISCLOSURES_BODY'] = str(row.cells[34].value)

		if str(row.cells[35].value) != '':
			email_vars['APP_RATELOCK_SUBJECT'] = str(row.cells[35].value)
		if str(row.cells[36].value) != '':
			email_vars['APP_RATELOCK_H1'] = str(row.cells[36].value)
		if str(row.cells[37].value) != '':
			email_vars['APP_RATELOCK_BODY'] = str(row.cells[37].value)

		if str(row.cells[38].value) != '':
			email_vars['APP_LOSUBMIT_SUBJECT'] = str(row.cells[38].value)
		if str(row.cells[39].value) != '':
			email_vars['APP_LOSUBMIT_H1'] = str(row.cells[39].value)
		if str(row.cells[40].value) != '':
			email_vars['APP_LOSUBMIT_BODY'] = str(row.cells[40].value)

		if str(row.cells[41].value) != '':
			email_vars['APP_DOCUMENT_SUBJECT'] = str(row.cells[41].value)
		if str(row.cells[42].value) != '':
			email_vars['APP_DOCUMENT_H1'] = str(row.cells[42].value)
		if str(row.cells[43].value) != '':
			email_vars['APP_DOCUMENT_BODY'] = str(row.cells[43].value)

		if str(row.cells[44].value) != '':
			email_vars['PROC_ASSIGN_SUBJECT'] = str(row.cells[44].value)
		if str(row.cells[45].value) != '':
			email_vars['PROC_ASSIGN_H1'] = str(row.cells[45].value)
		if str(row.cells[46].value) != '':
			email_vars['PROC_ASSIGN_BODY'] = str(row.cells[46].value)

		if str(row.cells[47].value) != '':
			email_vars['LO_ASSIGN_SUBJECT'] = str(row.cells[47].value)
		if str(row.cells[48].value) != '':
			email_vars['LO_ASSIGN_H1'] = str(row.cells[48].value)
		if str(row.cells[49].value) != '':
			email_vars['LO_ASSIGN_BODY'] = str(row.cells[49].value)

		if str(row.cells[50].value) != '':
			email_vars['LO_PREQUAL_SUBJECT'] = str(row.cells[50].value)
		if str(row.cells[51].value) != '':
			email_vars['LO_PREQUAL_H1'] = str(row.cells[51].value)
		if str(row.cells[52].value) != '':
			email_vars['LO_PREQUAL_BODY'] = str(row.cells[52].value)

		if str(row.cells[53].value) != '':
			email_vars['LO_CREDITREPORT_SUBJECT'] = str(row.cells[53].value)
		if str(row.cells[54].value) != '':
			email_vars['LO_CREDITREPORT_H1'] = str(row.cells[54].value)
		if str(row.cells[55].value) != '':
			email_vars['LO_CREDITREPORT_BODY'] = str(row.cells[55].value)

		if str(row.cells[56].value) != '':
			email_vars['LO_APPSUBMIT_SUBJECT'] = str(row.cells[56].value)
		if str(row.cells[57].value) != '':
			email_vars['LO_APPSUBMIT_H1'] = str(row.cells[57].value)
		if str(row.cells[58].value) != '':
			email_vars['LO_APPSUBMIT_BODY'] = str(row.cells[58].value)

		if str(row.cells[59].value) != '':
			email_vars['OPS_APPSUBMIT_SUBJECT'] = str(row.cells[59].value)
		if str(row.cells[60].value) != '':
			email_vars['OPS_APPSUBMIT_H1'] = str(row.cells[60].value)
		if str(row.cells[61].value) != '':
			email_vars['OPS_APPSUBMIT_BODY'] = str(row.cells[61].value)

		if str(row.cells[62].value) != '':
			email_vars['WORKFORCE_NEWACCOUNT_SUBJECT'] = str(row.cells[62].value)
		if str(row.cells[63].value) != '':
			email_vars['WORKFORCE_NEWACCOUNT_H1'] = str(row.cells[63].value)
		if str(row.cells[64].value) != '':
			email_vars['WORKFORCE_NEWACCOUNT_BODY'] = str(row.cells[64].value)

		if str(row.cells[65].value) != '':
			email_vars['WORKFORCE_RESETPASSWORD_SUBJECT'] = str(row.cells[65].value)
		if str(row.cells[66].value) != '':
			email_vars['WORKFORCE_RESETPASSWORD_H1'] = str(row.cells[66].value)
		if str(row.cells[67].value) != '':
			email_vars['WORKFORCE_RESETPASSWORD_BODY'] = str(row.cells[67].value)

		if str(row.cells[68].value) != '':
			email_vars['WORKFORCE_DOCUMENT_SUBJECT'] = str(row.cells[68].value)
		if str(row.cells[69].value) != '':
			email_vars['WORKFORCE_DOCUMENT_H1'] = str(row.cells[69].value)
		if str(row.cells[70].value) != '':
			email_vars['WORKFORCE_DOCUMENT_BODY'] = str(row.cells[70].value)

		if str(row.cells[71].value) != '':
			email_vars['WORKFORCE_REGISTRATION_SUBJECT'] = str(row.cells[71].value)
		if str(row.cells[72].value) != '':
			email_vars['WORKFORCE_REGISTRATION_H1'] = str(row.cells[72].value)
		if str(row.cells[73].value) != '':
			email_vars['WORKFORCE_REGISTRATION_BODY'] = str(row.cells[73].value)

		if str(row.cells[74].value) != '':
			email_vars['WORKFORCE_IPADDRESS_SUBJECT'] = str(row.cells[74].value)
		if str(row.cells[75].value) != '':
			email_vars['WORKFORCE_IPADDRESS_H1'] = str(row.cells[75].value)
		if str(row.cells[76].value) != '':
			email_vars['WORKFORCE_IPADDRESS_BODY'] = str(row.cells[76].value)

		if str(row.cells[77].value) != '':
			email_vars['APP_PREQUAL_SUBJECT'] = str(row.cells[77].value)
		if str(row.cells[78].value) != '':
			email_vars['APP_PREQUAL_H1'] = str(row.cells[78].value)
		if str(row.cells[79].value) != '':
			email_vars['APP_PREQUAL_BODY'] = str(row.cells[79].value)

		print('\nEmail configuration elements substituted from '+client_name+' email configurations Smartsheet')

    #CONVERTS THE PARAGRAPHS WITHIN BODY STRINGS INTO MULTIPLE "text" SEGMENTS WITHIN JSON FORMAT
		for email_item, email_content in email_vars.items():
			email_content = email_content.replace("\n\n",'''"\n                  },'''+"\n"+'''                  {'''+"\n"+'''                    "text": "''')
			if str(email_item).endswith('Y'):
				email_content = '''"'''+email_content+'''"\n                  }'''
			email_vars[email_item] = email_content

	    #CONVERTS DICTIONARY INTO VARIABLES REFERENCING STRINGS
		locals().update(email_vars)

	    #INSERT VARIABLES INTO JSON
		email_json = '''
	    {
	      "defaultTemplateContent": {
	        "content": {
	          "greeting": "Hello"
	        },
	        "company": {
	          "email-href": "mailto:'''+SENDER_EMAIL_ADDRESS+'''",
	          "email-info": "'''+SENDER_EMAIL_ADDRESS+'''",
	          "full-name": "'''+CLIENT_LEGAL_NAME+'''",
	          "nmls": "NMLS: '''+NMLS+'''",
	          "phone": "Phone: '''+PHONE_NUMBER+'''",
	          "signature": "'''+SIGNOFF+''',",
	          "team": "'''+TEAM_NAME+'''",
	          "logo": "whitefall-logo.png"
	        }
	      },
	      "templates": [
	        {
	          "templateBaseName": "whitefall-loan-officer-to-applicant",
	          "actions": {
	            "CO_APPLICANT_HAS_APPLIED" : {
	              "subject": "Borrower Wallet - Co-applicant ready to apply",
	              "content": {
	                "heading": "Borrower Wallet - Co-applicant ready to apply",
	                "btn-label": "Open Borrower Wallet",
	                "btn-link": "{{login-url}}",
	                "cta": "Please contact us if you have questions or need help.",
	                "body": [
	                  {
	                    "text": "A fellow applicant on your loan is ready to send in the loan application. Before your loan application can move forward, you need to do a few more things."
	                  },
	                  {
	                    "text": "Log in to your Borrower Wallet account and review your information in your Application Checklist. Make sure each item has a checkmark next to it. When you're ready, select the Apply Now button."
	                  }
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-first-name}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            },
	            "NEW_APPLICANT_ACCEPTED_INVITATION" : {
	              "subject": "Borrower Wallet - Co-applicant joined",
	              "content": {
	                "heading": "Borrower Wallet - Co-applicant joined",
	                "btn-label": "Open Borrower Wallet",
	                "body": [
	                  {
	                    "text": "A new person has been added as a co-applicant to your application!  If you have questions, log in to learn more, or contact your Loan Officer at any time."
	                  }
	                ]
	              }
	            },
	            "NOTIFY_APPLICANT_DOCUMENT_AVAILABLE" : {
	              "subject": "'''+APP_DOCUMENT_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_DOCUMENT_H1+'''",
	                "btn-label": "Open Borrower Wallet",
	                "btn-link": "{{login-url}}",
	                "cta": "Please contact us if you have questions or need help.",
	                "body": [
	                  {
	                    "text": '''+APP_DOCUMENT_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-first-name}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            },
	            "NOTIFY_APPLICANT_DISCLOSURES_ARE_READY_TO_SIGN" : {
	              "subject": "'''+APP_DISCLOSURES_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_DISCLOSURES_H1+'''",
	                "btn-label": "Open Borrower Wallet",
	                "btn-link": "{{login-url}}",
	                "body": [
	                  {
	                    "text": '''+APP_DISCLOSURES_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-first-name}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            },
	            "INVITE_EXISTING_FELLOW_APPLICANT" : {
	              "subject": "'''+APP_FELLOWEXISTING_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_FELLOWEXISTING_H1+'''",
	                "btn-label": "Open Borrower Wallet",
	                "btn-link": "{{bw-login-url}}",
	                "body": [
	                  {
	                    "text": '''+APP_FELLOWEXISTING_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-first-name}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            },
	            "INVITE_NEW_FELLOW_APPLICANT" : {
	              "subject": "'''+APP_FELLOWEXISTING_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_FELLOWEXISTING_H1+'''",
	                "btn-label": "Confirm Email",
	                "btn-link": "{{url}}",
	                "body": [
	                  {
	                    "text": '''+APP_FELLOWEXISTING_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-first-name}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            },
	            "INVITE_EXISTING_APPLICANT" : {
	              "subject": "'''+APP_INVITEEXISTING_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_INVITEEXISTING_H1+'''",
	                "btn-label": "Open Borrower Wallet",
	                "btn-link": "{{bw-login-url}}",
	                "body": [
	                  {
	                    "text": '''+APP_INVITEEXISTING_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-first-name}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            },
	            "NOTIFY_APPLICANT_LOAN_OFFICER_CHANGED" : {
	              "subject": "'''+APP_TEAMMEMBER_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_TEAMMEMBER_H1+'''",
	                "btn-label": "Open Borrower Wallet",
	                "btn-link": "{{open-dashboard}}",
	                "cta": "",
	                "body": [
	                  {
	                    "text": '''+APP_TEAMMEMBER_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-first-name}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            },
	            "PRE_QUALIFICATION_LETTER_FOR_APPLICANT" : {
	              "subject": "'''+APP_PREQUAL_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_PREQUAL_H1+'''",
	                "btn-label": "Open Borrower Wallet",
	                "body": [
	                  {
	                    "text": '''+APP_PREQUAL_BODY+'''
	                ]
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            },
	            "NOTIFY_APPLICANT_LOAN_OFFICER_SUBMITTED_APPLICATION" : {
	              "subject": "'''+APP_LOSUBMIT_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_LOSUBMIT_H1+'''",
	                "btn-label": "Open Borrower Wallet",
	                "btn-link": "{{open-dashboard}}",
	                "body": [
	                  {
	                    "text": '''+APP_LOSUBMIT_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-first-name}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            }
	          }
	        },
	        {
	          "templateBaseName": "whitefall-loan-officer-to-applicant-action-code",
	          "actions": {
	            "REGISTRATION_EMAIL_FOR_APPLICANT" : {
	              "subject": "'''+APP_REGISTRATION_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_REGISTRATION_H1+'''",
	                "btn-label": "Confirm Your Email",
	                "btn-link": "{{open-dashboard}}",
	                "cta": "If you received this email by mistake, or you don't want to use an online application, just delete it. You won't be signed up if you don't use the button.",
	                "body": [
	                  {
	                    "text": '''+APP_REGISTRATION_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{user-first-name}}",
	                "last-name": "{{user-last-name}}",
	                "user-email": "{{user-email}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            },
	            "INVITE_NEW_APPLICANT" : {
	              "subject": "'''+APP_INVITENEW_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_INVITENEW_H1+'''",
	                "btn-label": "Confirm Your Email",
	                "btn-link": "{{url}}",
	                "cta": "If you received this email by mistake, or you don't want to use an online application, just delete it. You won't be signed up if you don't use the button.",
	                "body": [
	                  {
	                    "text": '''+APP_INVITENEW_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-first-name}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            },
	            "MFA_EMAIL_FOR_APPLICANT" : {
	              "subject": "'''+APP_MFA_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_MFA_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{login-url}}",
	                "code-label": "Your Code",
	                "cta": "The passcode expires in 10 minutes. You can get an email with a new one by using the Create A New Passcode button on the Log In form.",
	                "body": [
	                  {
	                    "text": '''+APP_MFA_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-first-name}}",
	                "code": "{{mfa-token}}"
	              }
	            },
	            "RATE_LOCKED_EMAIL" : {
	              "subject": "'''+APP_RATELOCK_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_RATELOCK_H1+'''",
	                "btn-label": "Open Borrower Wallet",
	                "btn-link": "{{login-url}}",
	                "body": [
	                  {
	                    "text": '''+APP_RATELOCK_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-display-name}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}",
	                "loan-officer-last-name": "{{loan-officer-last-name?}}",
	                "loan-officer-email": "{{loan-officer-email?}}",
	                "loan-officer-title": "{{loan-officer-title?}}",
	                "loan-officer-phone": "{{loan-officer-phone?}}",
	                "loan-officer-nmls": "{{loan-officer-nmls?}}"
	              }
	            }
	          }
	        },
	        {
	          "templateBaseName": "whitefall-system-to-lender-users-applicant-update",
	          "defaultTemplateContent": {
	            "content": {
	              "greeting": "Hello"
	            }
	          },
	          "actions": {
	            "APPLICANT_REQUESTED_PRE_QUALIFICATION_LETTER" : {
	              "subject": "'''+LO_PREQUAL_SUBJECT+'''",
	              "content": {
	                "heading": "'''+LO_PREQUAL_H1+'''",
	                "btn-label": "Log In",
	                "body": [
	                  {
	                    "text": '''+LO_PREQUAL_BODY+'''
	                ]
	              }
	            }
	          }
	        },
	        {
	          "templateBaseName": "whitefall-system-to-applicant",
	          "defaultTemplateContent": {
	            "applicant": {
	              "first-name": "{{user-first-name}}"
	            }
	          },
	          "actions": {
	            "RESET_PASSWORD" : {
	              "subject": "'''+APP_RESETPASSWORD_SUBJECT+'''",
	              "content": {
	                "heading": "'''+APP_RESETPASSWORD_H1+'''",
	                "btn-label": "Reset Password",
	                "btn-link": "{{url}}",
	                "body": [
	                  {
	                    "text": '''+APP_RESETPASSWORD_BODY+'''
	                ]
	              }
	            },
	            "CHAT_MESSAGE_WAITING_APPLICANT" : {
	              "subject": "Borrower Wallet - Message Waiting",
	              "content": {
	                "heading": "Borrower Wallet - Message Waiting",
	                "btn-label": "Open Borrower Wallet",
	                "btn-link": "{{bw-login-url}}",
	                "body": [
	                  {
	                    "text": "You have a new message waiting for you in Borrower Wallet! Please log in to have a look."
	                  },
	                  {
	                    "text": "Thank you for being a customer!"
	                  }
	                ]
	              }
	            }
	          }
	        },
	        {
	          "templateBaseName": "whitefall-system-to-lender-users",
	          "defaultTemplateContent": {
	            "loan-officer": {
	              "loan-officer-signoff": "Thank you,",
	              "greeting": "Hello"
	            }
	          },
	          "actions": {
	            "NOTIFY_LOAN_OFFICER_NEW_LOAN_ASSIGNED" : {
	              "subject": "'''+LO_ASSIGN_SUBJECT+'''",
	              "content": {
	                "heading": "'''+LO_ASSIGN_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{login-url}}",
	                "body": [
	                  {
	                    "text": '''+LO_ASSIGN_BODY+'''
	                ]
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{workforce-user-first-name}}"
	              }
	            },
	            "NOTIFY_LOAN_PROCESSOR_NEW_LOAN_ASSIGNED" : {
	              "subject": "'''+PROC_ASSIGN_SUBJECT+'''",
	              "content": {
	                "heading": "'''+PROC_ASSIGN_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{login-url}}",
	                "body": [
	                  {
	                    "text": '''+PROC_ASSIGN_BODY+'''
	                ]
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{workforce-user-first-name}}"
	              }
	            },
	            "NOTIFY_LOAN_OFFICER_DISCLOSURES_ARE_READY_TO_SIGN" : {
	              "subject": "'''+LO_DISCLOSURES_SUBJECT+'''",
	              "content": {
	                "heading": "'''+LO_DISCLOSURES_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{login-url}}",
	                "body": [
	                  {
	                    "text": '''+LO_DISCLOSURES_BODY+'''
	                ]
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-name}}"
	              }
	            },
	            "NOTIFY_LOAN_OFFICER_NEW_NOT_IN_ADMIN" : {
	              "subject": "Whitefall - New loan assigned",
	              "content": {
	                "heading": "Whitefall - New loan assigned",
	                "btn-label": "Log In",
	                "body": [
	                  {
	                    "text": "You have a new applicant! This applicant is using Borrower Wallet, our point-of-sale tool. You are receiving this email because you don't have a Borrower Wallet account. Borrower Wallet is a welcoming, shared workspace where you can help your customers apply for a mortgage and achieve their dream of homeownership."
	                  },
	                  {
	                    "text": "To sign up for a Borrower Wallet account contact your System Admin or Ops Manager."
	                  }
	                ]
	              }
	            },
	            "REGISTRATION_EMAIL_COPY_FOR_LOAN_OFFICER" : {
	              "subject": "'''+WORKFORCE_REGISTRATION_SUBJECT+'''",
	              "content": {
	                "heading": "'''+WORKFORCE_REGISTRATION_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{open-dashboard}}",
	                "body": [
	                  {
	                    "text": '''+WORKFORCE_REGISTRATION_BODY+'''
	                ]
	              }
	            },
	            "RESET_LENDER_PLATFORM_PASSWORD" : {
	              "subject": "'''+WORKFORCE_RESETPASSWORD_SUBJECT+'''",
	              "content": {
	                "heading": "'''+WORKFORCE_RESETPASSWORD_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{url}}",
	                "cta": "If you did not request a password reset, just delete this email.",
	                "body": [
	                  {
	                    "text": '''+WORKFORCE_RESETPASSWORD_BODY+'''
	                ]
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{user-first-name}}"
	              }
	            },
	            "COMPLETE_ECONSENT_FORM_FOR_APPLICANT" : {
	              "subject": "Whitefall - Sign disclosures",
	              "content": {
	                "heading": "Whitefall - Sign disclosures",
	                "btn-label": "Log In",
	                "cta": "Use the button to Log In and begin the e-signing ceremony.",
	                "body": [
	                  {
	                    "text": "You are required to sign some documents online for Loan Number:"
	                  }
	                ]
	              }
	            },
	            "NEW_ACCOUNT_VERIFICATION_FOR_WORKFORCE_USER" : {
	              "subject": "'''+WORKFORCE_NEWACCOUNT_SUBJECT+'''",
	              "content": {
	                "heading": "'''+WORKFORCE_NEWACCOUNT_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{open-dashboard}}",
	                "cta": "If you received this email by mistake, just delete it. You won't be signed up if you don't use the button.",
	                "body": [
	                  {
	                    "text": '''+WORKFORCE_NEWACCOUNT_BODY+'''
	                ]
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name}}"
	              }
	            },
	            "CHAT_MESSAGE_WAITING_LOAN_OFFICER" : {
	              "subject": "Whitefall - Your Borrower Wallet account",
	              "content": {
	                "heading": "Whitefall - Your Borrower Wallet account",
	                "btn-label": "Log In",
	                "btn-link": "{{lp-login-url}}",
	                "body": [
	                  {
	                    "text": "You have a new message waiting for you in LO Assist! Please log in to have a look."
	                  }
	                ]
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{user-first-name}}"
	              }
	            },
	            "NOTIFY_LOAN_OFFICER_NEW_LOAN_APPLICATION_SUBMITTED" : {
	              "subject": "'''+LO_APPSUBMIT_SUBJECT+'''",
	              "content": {
	                "heading": "'''+LO_APPSUBMIT_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{login-url}}",
	                "body": [
	                  {
	                    "text": '''+LO_APPSUBMIT_BODY+'''
	                ]
	              },
	              "applicant": {
	                "first-name": "{{applicant-first-name}}"
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name}}"
	              }
	            },
	            "NOTIFY_WORKFORCE_USER_NEW_DOCUMENT_AVAILABLE" : {
	              "subject": "'''+WORKFORCE_DOCUMENT_SUBJECT+'''",
	              "content": {
	                "heading": "'''+WORKFORCE_DOCUMENT_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{login-url}}",
	                "body": [
	                  {
	                    "text": '''+WORKFORCE_DOCUMENT_BODY+'''
	                ]
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{workforce-user-first-name}}"
	              }
	            },
	            "CREDIT_REPORT_AVAILABLE_FOR_LOAN_OFFICER" : {
	              "subject": "'''+LO_CREDITREPORT_SUBJECT+'''",
	              "content": {
	                "heading": "'''+LO_CREDITREPORT_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{open-dashboard}}",
	                "body": [
	                  {
	                    "text": '''+LO_CREDITREPORT_BODY+'''
	                ]
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name}}"
	              }
	            },
	            "NOTIFY_OPS_MANAGER_NEW_LOAN_APPLICATION_SUBMITTED" : {
	              "subject": "'''+OPS_APPSUBMIT_SUBJECT+'''",
	              "content": {
	                "heading": "'''+OPS_APPSUBMIT_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{login-url}}",
	                "body": [
	                  {
	                    "text": "'''+OPS_APPSUBMIT_BODY+'''
	                ]
	              },
	              "loan-officer": {
	                "loan-officer-first-name": "{{loan-officer-first-name?}}"
	              }
	            },
	            "NOTIFY_WORKFORCE_USER_INVALID_IP_ADDRESS_LOGIN" : {
	              "subject": "'''+WORKFORCE_IPADDRESS_SUBJECT+'''",
	              "content": {
	                "heading": "'''+WORKFORCE_IPADDRESS_H1+'''",
	                "btn-label": "Log In",
	                "btn-link": "{{los-link}}",
	                "body": [
	                  {
	                    "text": '''+WORKFORCE_IPADDRESS_BODY+'''
	                ]
	              }
	            }
	          }
	        }
	      ]
	    }
	    '''
	    
		json_file_name = client_name+'_email_configs.json'
		with open (json_file_name,'w') as outfile:
			outfile.write(email_json)
		json_file_path = '/Users/kareygraham/parent/pystuff/'+json_file_name
		updated_attachment = ss.Attachments.attach_file_to_row(email_configurations,CLIENT_SS_ROW,(json_file_name, open(json_file_path, 'rb'), 'application/msword'))
		print('\nFile attached to '+client_name+' row in Email Configurations in Smartsheet')

	    #JIRA

		onboarding = '7170081336649604' #Client Assignments
		sheet = ss.Sheets.get_sheet(onboarding) #sheet = #Client Assignments
		for row in sheet.rows:
			if row.cells[0].value == client_name:
				ptech_pm = str(row.cells[1].value) 
				ptech_ia = str(row.cells[2].value) 
				ptech_ms = str(row.cells[3].value)  
				ptech_ps = str(row.cells[4].value)
		cs_assignment = F'''
	          ----
	          *For any questions, please contact a member of {client_name}'s implementation team listed below:*
	          ||Name||Position||
	          |{ptech_pm}|{client_name} Project Manager|
	          |{ptech_ia}|{client_name} Implementation Analyst|
	          |{ptech_ms}|{client_name} Mortgage Specialist|
	          '''
	  
		client_email = {
			#TICKET NAME: (Client Name): Requested Email Configurations
				'project':{'key':'TES'},
				#'project':{'key':'BW'},
				'summary': F"{client_name}: Requested Email Configurations",
				'description': F'''
				{client_name} has specified their email configrations in the attached JSON file. Please ensure the all emails generated all associated environments reflect these configurations.
				
	    		[^{json_file_name}]
				''' + cs_assignment,
				'issuetype':{'name':'Story'}
				#priority:{'name':'Medium'}
			}

		#CREATE JIRA TICKET AND ATTACH JSON FILE TO TICKET
		email_config_jira = jira.create_issue(fields=client_email)
		attach = json_file_path
		jira.add_attachment(issue=email_config_jira, attachment=attach,filename=json_file_name)

		print('\nTicket '+str(email_config_jira)+' created.')
